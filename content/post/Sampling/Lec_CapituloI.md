+++
date      = 2020-09-28
lastmod   = 2022-04-03
draft     = true
math      = true
+++

Encuestas y estudios por muestreo
================

Material tomado de **Gutiérrez, A. (2015). Estrategias de muestreo
Diseño de encuestas y estimación de parámetros. Ediciones de la U.**

## Conceptos metodológicos

-   **Población objetivo**: es la colección completa de todas las
    unidades que se quieren estudiar.
-   **Muestra**: es un subconjunto de la población.
-   **Unidad de muestreo**: es el objeto a ser seleccionado en la
    muestra que permitirá el acceso a la unidad de observación.
-   **Unidad de observación**: es el objeto sobre el que finalmente se
    realiza la medición.
-   **Variable de interés**: es la caracteríıstica propia de los
    individuos sobre la que se realiza la inferencia para resolver los
    objetivos de la investigación.

### Encuesta

Por **encuesta** se entiende una investigación estadística con las
siguientes características:

1.  El objetivo de una encuesta es proveer información acerca de la
    población finita y/o acerca de subpoblaciones de interés especial.
2.  Asociado con cada elemento de la población existe una o más
    variables de interés. Una encuesta permite conseguir información
    sobre características poblacionales desconocidas llamadaś
    parámetros. Estas son funciones de los valores de las variables de
    interés y son desconocidos y requeridos.
3.  El acceso y observación de los elementos de la población se
    establece mediante un algoritmo de muestreo, que es un mecanismo que
    asocia los elementos de la población con unidades de muestreo.
4.  Una muestra de elementos se escoge. Esto puede ser hecho mediante la
    selección de las unidades de observación en el esquema. Una muestra
    es probabilística si se realiza mediante un mecanismo probabilístico
    y se conoce la probabilidad de selección de todas las posibles
    muestras.
5.  Los elementos seleccionados en la muestra son observados y se
    realiza el proceso de medición; es decir para cada elemento de la
    muestra la variable de interés se mide y sus valores se graban.
6.  Los valores grabados de las variables son usados para calcular
    estimaciones de los parámetros de interés.
7.  Las estimaciones son finalmente publicadas. Estas sirven para la
    toma de decisiones.

### Marco de muestreo

Todo procedimiento de muestreo probabilístico requiere de un dispositivo
que permita identificar, seleccionar y ubicar a todos y cada uno de los
objetos pertenecientes a la población objetivo y que participara ́n en
la selección aleatoria. Este dispositivo se conoce con el nombre de
marco de muestreo. En investigaciones por muestreo se consideran dos
tipos de objetos:

-   **Elementos**: las unidades básicas e individuales sobre las que se
    realiza la medición.
-   **Conglomerado**: agrupación de elementos cuya característica
    principal es que son homogéneos dentro de sí, y heterogéneos entre
    sí.

Si no se dispone de un marco de elementos (o es muy costoso construirlo)
se debe recurrir a diseños de muestreo en conglomerados; es decir, que
se utilizan marcos de conglomerados. Por ejemplo, al realizar una
encuesta cuya unidad de observación sean las personas que viven en una
ciudad, es muy difícil poder acceder a un marco de muestreo de las
personas. Sin embargo, se puede tener acceso a la división
sociodemográfica de la ciudad y así seleccionar algunos barrios de la
ciudad, en una primera instancia y luego, seleccionar a las personas de
los barrios en una segunda instancia.

> **Ejemplo 1.1.1.** Suponga que una entidad oficial del gobierno de su
> país está interesada en la realización de una encuesta de desempleo
> con el fin de determinar a) cuántas personas actualmente pertenecen a
> la fuerza laboral, tanto en el país en cuestión como en sus regiones o
> subdivisiones geográficas y b) qué proporción de estas están
> desempleadas. Con base en lo anterior se tienen los siguientes
> aspectos para la realización de dicho estudio:

-   Población objetivo: Todas las personas de Colombia.
-   Dominios o subgrupos de interés: Grupos de edad, género, grupos
    ocupacionales y regiones del país.
-   Características de interés: Pertenencia a la fuerza laboral y estado
    de empleo. Estas toman valor uno o cero.
-   Parámetros de interés: Número total de personas pertenecientes a la
    fuerza laboral, número total de desempleados, proporción de
    desempleo.
-   Muestra: Se selecciona una muestra de la población con la ayuda de
    mecanismos de identificación y ubicación de las personas en el país.
-   Observaciones: Cada persona incluida en la muestra es visitada por
    un encuestador entrenado, quien hará preguntas siguiendo un
    cuestionario estandarizado y recolectará las respuestas en un
    instrumento apropiado.
-   Procesamiento: Los datos se editan y se preparan para la etapa de
    estimación.
-   Estimación: Se calculan las estimaciones sobre los parámetros de
    interés y también indicadores acerca de la incertidumbre de estas
    estimaciones.

### Sesgo

**Sesgo de selección**

Este tipo de sesgo ocurre cuando parte de la población objetivo no está
en el marco de muestreo. Una muestra a *conveniencia* es sesgada pues
las unidades más fáciles de elegir o las que más probablemente respondan
a la encuesta no son representativas de las unidades más difíciles de
elegir.

**Sesgo de medición**

Este tipo de sesgo ocurre cuando el instrumento con el que se realiza la
medición tiene una tendencia a diferir del valor verdadero que se desea
averiguar. Este sesgo debe ser considerado y minimizado en la etapa de
diseño de la encuesta.

## Marco y Lucy

El libro guía se encfoca en la aplicación una investigación
gubernamental que quiere responder al objetivo de medir el crecimiento
económico en el sector industrial.

Suponga que para completar el objetivo se ha propuesto desarrollar una
encuesta a las empresas que hacen parte del sector industrial, para
conocer el comportamiento del sector en términos de constructores
financieros, sociales y fiscales. Una vez termine el proceso de
medición, se pueden calcular estimaciones y construir indicadores que
permitan inferir acerca del crecimiento del sector en el periodo de
interés.

La **población objetivo** la conforman todas las empresas cuya actividad
principal esté ligada al sector industrial. El proceso de medición se
hará con base en las características de interés; a saber:

-   ingresos en el último año fiscal,
-   impuestos declarados en el último año fiscal y
-   número de empleados.
-   Adicionalmente, se requiere conocer si la empresa envía
    periódicamente algún tipo de material publicitario por correo
    electrónico porque se sospecha que las empresas obtienen más
    ingresos cuando utilizan esta estrategia publicitaria, lo cual es
    favorable para el gobierno porque aumenta la contribución impositiva
    y aumenta la creación de empleos.

Para obtener las respuestas, un entrevistador visitará las instalaciones
físicas de la empresa y realizará las siguientes preguntas:

1.  En el último año fiscal, ¿a cuánto ascendieron los ingresos en esta
    empresa?
2.  En el último año fiscal, ¿a cuánto ascendieron los impuestos
    declarados por esta empresa?
3.  Actualmente, ¿cuántos empleados laboran para esta empresa?
4.  ¿Esta empresa acostumbra a enviar periódicamente material
    publicitario por correo electrónico a sus clientes o potenciales
    clientes?

Se sabe que el tamaño de la población es de 2396 empresas. Dependiendo
de la estrategia de muestreo que se vaya a utilizar y de la calidad del
marco de muestreo, las unidades de muestreo pueden ser las mismas
empresas.

``` r
# Cargar librería
library(TeachingSampling)
```

    ## Loading required package: dplyr

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

    ## Loading required package: magrittr

``` r
# Cargar base de datos `BigLucy`
data(BigLucy)
# Nombres de las variables
names(BigLucy)
```

    ##  [1] "ID"        "Ubication" "Level"     "Zone"      "Income"    "Employees"
    ##  [7] "Taxes"     "SPAM"      "ISO"       "Years"     "Segments"

``` r
# Número de empresas y número de variables
dim(BigLucy)
```

    ## [1] 85296    11

``` r
# Primeras filas de la base de datos
head(BigLucy)
```

    ##             ID        Ubication Level    Zone Income Employees Taxes SPAM ISO
    ## 1 AB0000000001 C0212063K0089834 Small County1    281        41     3   no  no
    ## 2 AB0000000002 C0011268K0290629 Small County1    329        19     4  yes  no
    ## 3 AB0000000003 C0077703K0224194 Small County1    405        68     7   no  no
    ## 4 AB0000000004 C0091012K0210885 Small County1    360        89     5   no  no
    ## 5 AB0000000005 C0301070K0000827 Small County1    391        91     7  yes  no
    ## 6 AB0000000006 C0255289K0046608 Small County1    296        89     3   no  no
    ##   Years  Segments
    ## 1  14.0 County1 1
    ## 2  17.6 County1 1
    ## 3  13.6 County1 1
    ## 4  44.7 County1 1
    ## 5  23.3 County1 1
    ## 6  48.3 County1 1

Además de la librería `TeachingSampling`, vamos a usar las librerías
`tidyverse` y `ggplo2` para manipular y graficar datos.

``` r
# Cargar librerías
library(tidyverse)
```

``` r
library(ggplot2)

# Estadísticas descriptivas para las variables `Income`, `Employees`, `Taxes`, `SPAM`, `ISO` y `Years`
BigLucy %>% select(Income:Years) %>% summary()
```

    ##      Income         Employees          Taxes         SPAM        ISO       
    ##  Min.   :   1.0   Min.   :  1.00   Min.   :  0.50   no :33355   no :56896  
    ##  1st Qu.: 230.0   1st Qu.: 38.00   1st Qu.:  2.00   yes:51941   yes:28400  
    ##  Median : 388.0   Median : 62.00   Median :  6.00                          
    ##  Mean   : 429.5   Mean   : 63.22   Mean   : 11.82                          
    ##  3rd Qu.: 570.0   3rd Qu.: 84.00   3rd Qu.: 15.00                          
    ##  Max.   :2510.0   Max.   :263.00   Max.   :305.00                          
    ##      Years      
    ##  Min.   : 1.00  
    ##  1st Qu.:13.10  
    ##  Median :25.40  
    ##  Mean   :25.41  
    ##  3rd Qu.:37.70  
    ##  Max.   :50.00

Calculemos el ingreso total por nivel de la compañía:

``` r
BigLucy %>% group_by(Level) %>% summarize(sum(Income))
```

    ## # A tibble: 3 × 2
    ##   Level  `sum(Income)`
    ##   <fct>          <int>
    ## 1 Big          3629710
    ## 2 Medium      17057285
    ## 3 Small       15947738

``` r
# Usar kable para una mejor visualización
library(knitr)
BigLucy %>% group_by(Level) %>% summarize(Total = sum(Income)) %>% kable
```

| Level  |    Total |
|:-------|---------:|
| Big    |  3629710 |
| Medium | 17057285 |
| Small  | 15947738 |

Ahora el ingreso por nivel y si envían correos electrónicos o no

``` r
BigLucy %>% group_by(Level,SPAM) %>% summarize(Total = sum(Income)) %>% kable
```

    ## `summarise()` has grouped output by 'Level'. You can override using the `.groups` argument.

| Level  | SPAM |    Total |
|:-------|:-----|---------:|
| Big    | no   |  1116990 |
| Big    | yes  |  2512720 |
| Medium | no   |  6679820 |
| Medium | yes  | 10377465 |
| Small  | no   |  6288497 |
| Small  | yes  |  9659241 |

Este formato de impresión es el formato “largo”, usemos el formato
“ancho”:

``` r
library(tidyr)
BigLucy %>% group_by(Level,SPAM) %>% summarize(Total = sum(Income)) %>% 
   pivot_wider(names_from = SPAM, values_from = Total)%>%kable
```

    ## `summarise()` has grouped output by 'Level'. You can override using the `.groups` argument.

| Level  |      no |      yes |
|:-------|--------:|---------:|
| Big    | 1116990 |  2512720 |
| Medium | 6679820 | 10377465 |
| Small  | 6288497 |  9659241 |

``` r
# O
BigLucy %>% group_by(Level,SPAM) %>% summarize(Total = sum(Income)) %>% 
   pivot_wider(names_from = Level, values_from = Total)%>%kable
```

    ## `summarise()` has grouped output by 'Level'. You can override using the `.groups` argument.

| SPAM |     Big |   Medium |   Small |
|:-----|--------:|---------:|--------:|
| no   | 1116990 |  6679820 | 6288497 |
| yes  | 2512720 | 10377465 | 9659241 |

Consideremos algunos gráficos para darnos una idea de las relaciones
entre algunas de las variables

``` r
library(ggplot2)
library(ggpubr)
p1 = BigLucy %>% ggplot(aes(x = Level, y = Income)) +
  geom_boxplot()
p2 = BigLucy %>% ggplot(aes(x = Level, y = Employees)) +
  geom_boxplot()
p3 = BigLucy %>% ggplot(aes(x = Level, y = log(Taxes))) +
  geom_boxplot()
p4 = BigLucy %>% ggplot(aes(x = Level, y = Years)) +
  geom_boxplot()
ggarrange(p1,p2,p3,p4,ncol=2, nrow = 2)
```

![](http://alexrojas.netlify.com/media/Sampling/Graficas1-1.png)<!-- -->

``` r
library(GGally)
```

``` r
BigLucy %>% select(Income,Employees,Taxes, Years) %>% ggpairs()
```

![](http://alexrojas.netlify.com/media/Sampling/Graficas2-1.png)<!-- -->
